{% load leaflet_tags %}

<head>
    {% leaflet_js %}
    {% leaflet_css %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
</head>

<body>

    <h1>Sélectionner une piste pour afficher ses forêts voisines !</h1>

    <div id="slopeForests" style="width: 100%; height: 100%">

        {% leaflet_map "slopeForests" callback="main_map_init" %}
        <script type="text/javascript">

            // init map at a certain position and zoom
            function main_map_init(map, options) {
                map.setView([46.211657, 7.481341], 14);
            
            // display all slopes
            $.getJSON("{% url 'skiSlopesjson' %}", function (data) {
                L.geoJson(data, {style: function (feature) {return { color: 'grey' };},
                        onEachFeature: onEachFeature,}).addTo(map);})

            function onEachFeature(feature, layer) {
                if (feature.properties) {
                    layer.bindPopup(feature.properties.name);
                    layer.on('click', () => {window.location.href = '/MontNoble/slopeForests/' + feature.properties.pk;})
                }
            }
        }

        </script>
    </div>
</body>