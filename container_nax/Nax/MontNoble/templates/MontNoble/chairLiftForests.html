{% load leaflet_tags %}
<head>
    <title>646-1 Projet Nax Mont-Noble - détail vue piste</title> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    {% leaflet_js %} {% leaflet_css %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>  
</head>
<body>
    <!-- Navbar -->
    <div class="w3-top">
        <div class="w3-bar w3-white w3-wide w3-padding w3-card">
            <a href="/" class="w3-bar-item w3-button"><b>646-1</b> Domaine skiable Nax Mont-Noble</a>
            <!-- Float links to the right. Hide them on small screens -->
            <div class="w3-right w3-hide-small">
                <a href="/skiDomain" class="w3-bar-item w3-button">Vue générale</a>
                <a href="/slopesForests" class="w3-bar-item w3-button">Domaine forestier</a>
                <a href="/slopesServices" class="w3-bar-item w3-button">Restauration</a>
            </div>
        </div>
    </div>
    <!-- Header -->
    <header class="w3-display-container w3-content w3-wide" style="max-width:1500px; padding-top:60px;" id="chairLiftForestsHeader">
        <img class="w3-image" src="https://www.thomascrauwels.ch/wp-content/uploads/2020/10/panorama-du-valais-202008_dsc7336-panorama-scaled-scaled-scaled-2048x410.jpg" alt="Domaine skiable, picture by @thomascrauwels" style="width:1500px; height:180px; object-fit:none; object-position: 0 0;">
        <div class="w3-display-middle w3-margin-top w3-center">
            <h1 class="w3-xxlarge w3-text-white"><span class="w3-padding w3-black w3-opacity-min"><b>NAX TÉLÉ MONT-NOBLE</b></span></h1>
        </div>
    </header>
    <!-- Page content -->
    <!-- Title -->
    <div class="w3-display-container w3-content w3-wide" style="max-width:1500px; padding-top:60px;">
        <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16" id="slopeName"></h3>
    </div>
    <!-- Map -->
    <div class="w3-display-container w3-content w3-wide" style="max-width:1500px; min-height: 600px;" id="slopeForests">
        <!-- Map Section -->
        {% leaflet_map "slopeForests" callback="main_map_init" %}
        <script type="text/javascript">

            // init map at a certain position and zoom
            function main_map_init(map, options) {
                map.setView([46.211657, 7.481341], 14);

                // load forests context and parse it as json
                var neighborForests = JSON.parse("{{ neighborForests|escapejs }}");
                L.geoJson(neighborForests, {
                    style: function (feature) {
                        return { color: 'green' };
                    }, onEachFeature: onEachFeature
                }).addTo(map);

                // load slope context and parse it as json
                var chairLift = JSON.parse("{{ chairLift|escapejs }}");
                L.geoJson(chairLift, {
                    style: function (feature) {return { color: 'red' };}
                    , onEachFeature: onEachFeature
                }).addTo(map);
                
                // Set page title
                document.getElementById("slopeName").textContent = chairLift.features[0].properties.name
                + " et ses " + neighborForests.features.length + " forêts"
            }

            function onEachFeature(feature, layer) {
                if (feature.properties) {
                    layer.bindPopup(feature.properties.name);
                }
            }
        </script>
    </div>
</body>